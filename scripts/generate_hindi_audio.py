#!/usr/bin/env python3
"""Generate Hindi TTS audio for all 48 Bhaktamar Stotra verses using NVIDIA Riva"""

import os
import wave
import time

import riva.client

# NVIDIA API Configuration
API_KEY = "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"
SERVER = "grpc.nvcf.nvidia.com:443"
FUNCTION_ID = "877104f7-e885-42b9-8de8-f6e4c6303969"
VOICE_HINDI = "Magpie-Multilingual.HI-IN.Meera"  # Hindi voice
SAMPLE_RATE = 22050

# Hindi explanations for each stotra (kid-friendly)
HINDI_TEXTS = [
    "कल्पना करो कि प्यार से झुकने वाले देवताओं के मुकुटों पर चमकते हुए रत्न हैं! उनका प्रकाश सारे अंधकार को दूर कर देता है। भगवान आदिनाथ के चरण एक मजबूत रस्सी की तरह हैं जो समुद्र में डूबते लोगों को बचाती है।",
    "स्वर्ग के सबसे बुद्धिमान देवता भगवान आदिनाथ की सुंदर गीतों से स्तुति करते हैं! उनके गीत इतने अद्भुत हैं कि तीनों लोकों में सभी उन्हें सुनना पसंद करते हैं। अब मैं भी इस महान प्रभु की स्तुति करूंगा!",
    "भले ही मैं बहुत बुद्धिमान नहीं हूं, जब मैं भगवान आदिनाथ की स्तुति करने की कोशिश करता हूं, तो सुंदर शब्द जादू की तरह बहने लगते हैं! यह ऐसा है जैसे शक्तिशाली सांपों के पास रहने वाले छोटे जीव भी बहादुर हो जाते हैं!",
    "भगवान आदिनाथ में इतने अच्छे गुण हैं - एक अंतहीन समुद्र की तरह! स्वर्ग का सबसे बुद्धिमान शिक्षक भी उन सबका वर्णन नहीं कर सकता। यह मगरमच्छों से भरे विशाल समुद्र को केवल अपनी बाहों से तैरकर पार करने जैसा असंभव है!",
    "भले ही मैं इसमें बहुत अच्छा नहीं हूं, भगवान आदिनाथ के लिए मेरा प्यार मुझे कोशिश करने के लिए प्रेरित करता है! जैसे एक मां हिरणी अपने बच्चे की रक्षा के लिए बहादुरी से एक डरावने शेर का सामना करती है - प्यार हमें बहादुर बनाता है!",
    "मुझे ज्यादा कुछ नहीं पता और बुद्धिमान लोग मुझ पर हंस सकते हैं। लेकिन भगवान आदिनाथ के लिए मेरा प्यार मुझे गाने के लिए मजबूर करता है! जैसे एक छोटी कोयल वसंत में सुंदर आम के फूलों को देखकर अपना मधुर गीत गाती है!",
    "जब हम भगवान आदिनाथ की स्तुति करते हैं, तो हमने जो भी बुरे काम किए हैं वे जल्दी से गायब हो जाते हैं - जादू की तरह! यह ठीक वैसा ही है जैसे सुबह चमकदार सूरज आता है और रात के सारे अंधकार को दूर कर देता है!",
    "भगवान आदिनाथ की मदद से, मुझ जैसा कोई भी सुंदर स्तुति लिख सकता है! यह कमल के पत्ते पर एक छोटी पानी की बूंद की तरह है - यह एक असली मोती की तरह चमकदार और सुंदर हो जाती है! अच्छे लोग इन शब्दों को सुनना पसंद करेंगे!",
    "भगवान आदिनाथ की स्तुति करने से हमारी सभी गलतियां दूर हो जाती हैं! लेकिन उनके बारे में बात करना भी सभी की मदद करता है! यह ऐसा है जैसे सूरज, दूर से भी, सुंदर कमल के फूलों को खिलाता है!",
    "यहां कुछ अद्भुत है - जब हम सच्चे दिल से भगवान आदिनाथ की स्तुति करते हैं, तो हम उनके जैसे बन सकते हैं! एक सच्चे अमीर व्यक्ति को साझा करना चाहिए और दूसरों को भी अमीर बनने में मदद करनी चाहिए। भगवान आदिनाथ हमारे साथ अपनी अच्छाई साझा करते हैं!",
    "एक बार जब आप भगवान आदिनाथ को देख लेते हैं, तो आप देखना बंद नहीं कर सकते - वे बहुत सुंदर हैं! उन्हें देखने के बाद, कुछ भी उतना अच्छा नहीं लगता। जैसे स्वादिष्ट मीठा दूध पीने के बाद, कौन खारा समुद्री पानी पीना चाहेगा?",
    "भगवान आदिनाथ विशेष, शांतिपूर्ण, चमकते परमाणुओं से बने थे! ये विशेष परमाणु इतने दुर्लभ हैं - वे सभी केवल उन्हें बनाने के लिए उपयोग किए गए थे! इसीलिए पूरे ब्रह्मांड में कोई और उनके जितना अद्भुत नहीं दिखता!",
    "भगवान आदिनाथ का चेहरा इतना सुंदर है कि हर कोई - देवता, लोग, यहां तक कि जादुई सांप भी - उसे देखना बंद नहीं कर सकते! उनके चेहरे की तुलना में, चांद भी गंदा और पीला दिखता है, जैसे एक सूखा पत्ता!",
    "भगवान आदिनाथ के अच्छे गुण पूर्णिमा से भी अधिक चमकते हैं! वे तीनों लोकों में फैल जाते हैं! और जो कोई भी उनकी शरण लेता है वह जहां चाहे जा सकता है - कोई उन्हें रोक नहीं सकता!",
    "सबसे सुंदर देवदूतियां भी भगवान आदिनाथ को विचलित नहीं कर सकीं! उनका मन पूरी तरह शांत रहा। यह मंदार पर्वत की तरह है - सबसे बड़ा पर्वत - दुनिया के अंत में भी सबसे तेज हवाएं इसे हिला नहीं सकतीं!",
    "एक दीपक की लौ चमकदार लग सकती है, लेकिन भगवान आदिनाथ के चेहरे की तुलना में यह कुछ भी नहीं है! उनका चेहरा सबसे सुंदर चांद की तरह चमकता है - कोई दीपक या असली चांद भी इसकी तुलना नहीं कर सकता!",
    "कुछ लोगों ने भगवान आदिनाथ से कई, कई जन्मों से प्यार किया है! वे उन्हें देखने के लिए इतने लंबे समय से इंतजार कर रहे हैं! उनके लिए, भगवान के बारे में सुंदर शब्द सुनना सबसे अच्छा उपहार है!",
    "भगवान आदिनाथ के शब्द इतने शक्तिशाली और सुंदर हैं कि उन्हें किसी सजावट की जरूरत नहीं है! वे पहले से ही परिपूर्ण हैं! जैसे जब शुद्ध पानी चंदन पर बहता है - मीठी खुशबू रहती है और धुलती नहीं!",
    "भगवान आदिनाथ को देखने के बाद, विष्णु और शिव जैसे अन्य महान देवता भी कम अद्भुत लगते हैं! एक बार जब आप सबसे अच्छा देख लेते हैं, तो कुछ भी आपके दिल को इतना खुश नहीं कर सकता - अगले जन्म में भी नहीं!",
    "कई माताओं के अपने अच्छे कर्मों के कारण कई बच्चे होते हैं। लेकिन भगवान आदिनाथ अतिरिक्त विशेष हैं - देवता, मनुष्य और सिद्ध सभी उनकी पूजा करते हैं क्योंकि वे वो हैं जो सभी को हमेशा के लिए मुक्त और खुश होने में मदद कर सकते हैं!",
    "बुद्धिमान ऋषि कहते हैं कि भगवान आदिनाथ एक चमकदार सूरज की तरह हैं - शुद्ध और सभी अंधकार से परे! जब आप वास्तव में उन्हें समझ जाते हैं, तो आप मृत्यु को भी हरा सकते हैं! वे सच्ची खुशी का एकमात्र मार्ग हैं!",
    "अच्छे लोग भगवान आदिनाथ का कई तरह से वर्णन करते हैं: वे कभी नहीं बदलते, वे हर जगह हैं, उन्हें पूरी तरह समझना असंभव है, वे पहले हैं, वे सब कुछ के स्वामी हैं, वे सभी इच्छाओं को नियंत्रित करते हैं, और वे शुद्ध ज्ञान हैं!",
    "भगवान आदिनाथ को बुद्ध कहा जाता है क्योंकि देवता उनकी बुद्धि की पूजा करते हैं! उन्हें शंकर कहा जाता है क्योंकि वे तीनों लोकों की मदद करते हैं! वे मुक्ति के मार्ग के निर्माता हैं! वे वास्तव में अब तक के सबसे महान व्यक्ति हैं!",
    "मैं भगवान आदिनाथ को प्रणाम करता हूं जो सबके दुख दूर करते हैं! मैं उन्हें प्रणाम करता हूं जो पृथ्वी पर सबसे सुंदर रत्न हैं! मैं सभी लोकों के सबसे बड़े स्वामी को प्रणाम करता हूं! मैं उन्हें प्रणाम करता हूं जो समस्याओं के भयानक समुद्र को सुखा सकते हैं!",
    "भगवान आदिनाथ अच्छे गुणों से इतने भरे हुए हैं कि किसी बुरी चीज के लिए कोई जगह नहीं है! सपनों में भी कोई दोष या बुरी चीजें उनके पास कभी नहीं आईं - वे उन्हें देखने से भी डरती हैं!",
    "भगवान आदिनाथ एक सुंदर अशोक के पेड़ के नीचे बैठते हैं और प्रकाश से चमकते हैं! वे इतने चमकदार हैं - जैसे बादल के पीछे से सूरज झांकता है, सारे अंधकार को दूर करता है!",
    "भगवान आदिनाथ का शरीर शुद्ध सोने की तरह चमकता है! उनके चारों ओर सुंदर सफेद पंखे लहराते हैं! वे जादुई मेरु पर्वत की सुनहरी चोटी की तरह दिखते हैं जिसके किनारों से चांद जैसी सफेद पानी की धाराएं बहती हैं!",
    "भगवान आदिनाथ के ऊपर तीन सुंदर छत्र तैरते हैं! वे चांद की तरह चमकदार हैं और गर्म सूरज को दूर रखते हैं! उनसे मोतियों की मालाएं लटकती हैं, जो सबको बताती हैं कि वे तीनों लोकों के राजा हैं!",
    "भगवान आदिनाथ के लिए आकाश में जादुई ढोल बजते हैं! उनकी गहरी, गूंजती आवाजें हर दिशा में भर जाती हैं! वे सबको बताते हैं कि सच्चे राजा ने जीत लिया है और तीनों लोकों के लोगों को जश्न मनाने के लिए आमंत्रित करते हैं!",
    "भगवान आदिनाथ के शाही दरबार में आकाश से जादुई फूलों की वर्षा होती है! मंदार और पारिजात जैसे सुंदर स्वर्गीय फूल मीठी खुशबू और ठंडी हवाओं के साथ धीरे-धीरे गिरते हैं - जैसे अब तक की सबसे अद्भुत फूलों की पार्टी!",
    "यहां तक कि देवताओं के राजा इंद्र और अन्य सभी देवता भी भगवान आदिनाथ को प्रणाम करते हैं! उनके मुकुटों के चमकीले रत्न उनके कमल चरणों को इतनी सुंदरता से चमकाते हैं, उनके पूरे चेहरे को रोशन करते हैं!",
    "कमल जैसी आंखों वाली सुंदर देवदूतियां भगवान आदिनाथ की सेवा करती हैं, ठंडे पंखे लहराती हैं! दिव्य सहायकों से घिरे, उनकी महिमा तीनों लोकों पर विजय प्राप्त करती है और सभी अंधेरे, घमंडी विचारों को नष्ट करती है!",
    "भगवान आदिनाथ की भुजाएं कपूर की तरह शुद्ध सफेद हैं और झंडों वाले शाही हाथियों के सुंदर सिरों की तरह चमकती हैं! जब मैं उन्हें प्रणाम करता हूं, तो मेरी सारी बुरी आदतें और गलतियां डरकर भाग जाती हैं!",
    "भगवान आदिनाथ सुंदरता से घिरे एक भव्य सिंहासन पर बैठते हैं और लहराते पंखों की रोशनी से चमकते हैं! वे एक सुंदर रत्न की तरह हों जो मुझे अच्छाई से सबके दिल जीतने में मदद करे!",
    "भगवान आदिनाथ का सुंदर कमल जैसा चेहरा हमेशा मेरे दिल में चमके और कभी न जाए - सपनों में भी! वे मेरे नेता हैं जो जीवन की मुश्किलों के विशाल समुद्र को पार करने में मेरी मदद करेंगे!",
    "मुझे भगवान आदिनाथ की स्तुति करने में शर्म नहीं आती भले ही मैं इसमें बहुत अच्छा नहीं हूं! यह एक प्यारे छोटे बच्चे की तरह है जो दर्पण में चांद का प्रतिबिंब देखता है और खुशी से उसे छूता है, यह नहीं जानते कि असली चांद आकाश में दूर है!",
    "कुछ लोग मेरे शब्दों की आलोचना कर सकते हैं क्योंकि वे गलतियां खोजते हैं। लेकिन भगवान आदिनाथ के लिए मेरा प्यार मुझे उनकी स्तुति करने के लिए मजबूर करता है! कौन मेरी स्तुति गाने में मेरी मदद करेगा भले ही मेरे शब्द सरल हों?",
    "भगवान आदिनाथ के लिए थोड़ा सा प्यार भी बड़े प्यार के बराबर है! कृपया मेरी छोटी भेंट स्वीकार करें! जैसे सबसे कीमती हीरा भी बस एक कान की बाली का हिस्सा बन जाता है - मेरा छोटा प्यार भी उनके लिए विशेष है!",
    "मैंने भगवान आदिनाथ के लिए उनके अद्भुत गुणों से बुनी हुई प्रशंसाओं की एक सुंदर माला बनाई! जैसे मीठा शहद फूलों से आता है (फलों से नहीं), कृपया मेरे प्यार भरे शब्दों को स्वीकार करें और उन्हें उपहार के रूप में अपने सिर पर धारण करें!",
    "मैंने ये प्रशंसाएं अपने पूरे दिल से भगवान आदिनाथ को खुश करने के लिए लिखीं! मेरी सबसे बड़ी इच्छा है कि ये शब्द मुझे उनके करीब लाएं - न केवल अभी, बल्कि मेरे सभी भविष्य के जन्मों में भी! भगवान के साथ हमेशा के लिए मित्र!",
    "अगर आप हर दिन प्यार से भगवान आदिनाथ की इन स्तुतियों को पढ़ते हैं, तो अद्भुत चीजें होती हैं! आपको सभी परेशानियों से मुक्ति मिलेगी, जीवन में बहुत अच्छी चीजें मिलेंगी, और अंततः सबसे बड़ी खुशी - मोक्ष प्राप्त होगा!",
    "इस विशेष भजन को स्वर्ग के जादुई प्राणियों द्वारा आशीर्वाद दिया गया है! यह हमारे जीवन में अच्छी चीजों को बुरी चीजों से अलग करने में मदद करता है। भगवान आदिनाथ, कृपया इन स्तुतियों को स्वीकार करें जो हमें मुक्त होने में मदद करेंगी!",
    "जो लोग हर दिन मुस्कान के साथ खुशी से इन सुंदर स्तुतियों को पढ़ते हैं उन्हें अद्भुत उपहार मिलते हैं! ये उपहार एक जादुई नाव की तरह हैं जो उन्हें जीवन के उतार-चढ़ाव के बड़े समुद्र में नौकायन करने में मदद करती है!",
    "समर्पित देवदूतों के मुकुटों पर चमकते रत्न सब कुछ रोशन करते हैं और बुरे कर्मों के सभी अंधकार को नष्ट करते हैं! मैं भगवान आदिनाथ के चरणों को प्रणाम करता हूं - वे समय की शुरुआत से डूबते लोगों को बचाते आ रहे हैं!",
    "जो लोग हर शाम भगवान आदिनाथ के अद्भुत गुणों को याद करके उनकी पूजा करते हैं वे जीवन की सभी डरावनी चीजों से पूरी तरह मुक्त हो जाएंगे! कोई और डर नहीं - बस स्वतंत्रता और खुशी!",
    "अगर आप हमेशा रहने वाली खुशी, एक महान जीवन, कोई दर्द नहीं, और एक साफ दिल चाहते हैं - तो भगवान आदिनाथ की इन स्तुतियों को गाएं! जल्दी मिलने वाले सुख टिकते नहीं, लेकिन एक शांत, मजबूत मन होना वास्तव में महत्वपूर्ण है!",
    "हम भगवान ऋषभ (आदिनाथ) की पूजा करते हैं जो सूरज की तरह चमकते हैं! वे पहले महान शिक्षक थे, राजा नाभि के पुत्र, अनंत अच्छे गुणों के साथ! वे शुद्ध हैं, सभी गंदगी से मुक्त, और सभी को अद्भुत आशीर्वाद देते हैं!",
    "यह विशेष भक्तामर प्रार्थना बहुत पहले बुद्धिमान ऋषि मानतुंग द्वारा लिखी गई थी! जो कोई भी इसे हर दिन पढ़ता है, या इसे सुनता भी है, जीवन में सफल होगा! ये जादुई शब्द सभी को आशीर्वाद देते हैं!",
]

def create_riva_service():
    """Create and return the Riva TTS service."""
    metadata = [
        ["function-id", FUNCTION_ID],
        ["authorization", f"Bearer {API_KEY}"],
    ]
    auth = riva.client.Auth(None, True, SERVER, metadata)
    return riva.client.SpeechSynthesisService(auth)

def synthesize_speech(service, text: str, output_file: str):
    """Generate speech from text using NVIDIA Riva TTS in Hindi."""
    print(f"  Generating: {text[:50]}...")

    try:
        audio_data = b""
        responses = service.synthesize_online(
            text,
            VOICE_HINDI,
            "hi-IN",
            sample_rate_hz=SAMPLE_RATE,
            zero_shot_audio_prompt_file=None,
            zero_shot_quality=20,
            custom_dictionary={},
        )

        for resp in responses:
            audio_data += resp.audio

        with wave.open(output_file, 'wb') as wav_file:
            wav_file.setnchannels(1)
            wav_file.setsampwidth(2)
            wav_file.setframerate(SAMPLE_RATE)
            wav_file.writeframes(audio_data)

        print(f"  Saved: {output_file} ({len(audio_data)} bytes)")
        return True

    except Exception as e:
        print(f"  Error: {e}")
        return False

def main():
    """Generate Hindi audio for all 48 stotras."""
    output_dir = "../public/audio/hi"
    os.makedirs(output_dir, exist_ok=True)

    print("=" * 60)
    print("Bhaktamar Stotra Hindi Audio Generator")
    print("Using NVIDIA Riva TTS (Magpie Multilingual - Hindi)")
    print("=" * 60)
    print()

    print("Connecting to NVIDIA Riva TTS service...")
    service = create_riva_service()
    print("Connected!")
    print()

    # Generate intro
    print("Generating Hindi introduction...")
    intro_text = "भक्तामर स्तोत्र में आपका स्वागत है! इस पवित्र भजन में 48 श्लोक हैं जो प्रथम तीर्थंकर भगवान आदिनाथ की स्तुति करते हैं। आइए प्यार और भक्ति के साथ हर दिन एक श्लोक सीखें।"
    synthesize_speech(service, intro_text, f"{output_dir}/intro.wav")
    print()

    success_count = 0
    for i, text in enumerate(HINDI_TEXTS, 1):
        print(f"[{i}/48] Verse {i}")
        output_file = f"{output_dir}/stotra_{i}.wav"

        if synthesize_speech(service, text, output_file):
            success_count += 1

        time.sleep(0.5)
        print()

    print("=" * 60)
    print(f"Hindi audio generation complete!")
    print(f"Successfully generated: {success_count}/48 audio files")
    print(f"Output directory: {output_dir}")
    print("=" * 60)

if __name__ == "__main__":
    main()
